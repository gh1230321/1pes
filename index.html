<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Phone Parts Pro</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">


    <style>
    
    
    
     @keyframes shake {
    0%, 100% { transform: translate(0, 0); }
    25% { transform: translate(-4px, 4px) rotate(-3deg); }
    50% { transform: translate(4px, -4px) rotate(3deg); }
    75% { transform: translate(-4px, 4px) rotate(-3deg); }
}

@keyframes explode {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.6); opacity: 0.7; filter: blur(3px); }
    100% { transform: scale(2); opacity: 0; filter: blur(6px); }
}

@keyframes screenPop {
    0% { transform: scale(0) rotate(0deg); opacity: 0; box-shadow: none; }
    50% { transform: scale(1.1) rotate(360deg); opacity: 1; box-shadow: 0 0 20px rgba(70, 130, 180, 0.8), 0 0 40px rgba(70, 130, 180, 0.4); }
    100% { transform: scale(1) rotate(720deg); opacity: 1; box-shadow: 0 0 15px rgba(70, 130, 180, 0.6); }
}

@keyframes pulseGlow {
    0% { box-shadow: 0 0 15px rgba(70, 130, 180, 0.6); }
    50% { box-shadow: 0 0 25px rgba(70, 130, 180, 1), 0 0 40px rgba(70, 130, 180, 0.5); }
    100% { box-shadow: 0 0 15px rgba(70, 130, 180, 0.6); }
}

@keyframes textFadeIn {
    0% { opacity: 0; transform: translateY(10px); }
    100% { opacity: 1; transform: translateY(0); }
}

/* تعديل المسافات بين الشعار والهيدر وشريط الأخبار */
.notification-container {
    position: relative;
    width: 160px;
    height: 160px;
    margin: 0 auto 4px;
}



.notification {
    position: absolute;
    top: 0;
    left: 0;
    width: 160px; /* مطابقة حجم الشعار */
    height: 160px; /* مطابقة حجم الشعار */
    background: linear-gradient(45deg, #4682B4, #20B2AA);
    border: 3px solid #4682B4;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    transform: scale(0);
    z-index: 2;
}

.notification.show {
    animation: screenPop 0.7s ease-out forwards, pulseGlow 1.5s infinite;
}

.notification-text {
    font-family: 'Tajawal', sans-serif;
    font-size: 18px; /* يمكنك زيادته إلى 20px إذا كان النص صغيرًا جدًا */
    font-weight: 700;
    color: #ffffff;
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.8);
    padding: 10px;
    text-align: center;
    max-width: 140px; /* زيادة لتناسب الحجم الجديد */
    opacity: 0;
    letter-spacing: 1px;
}

.notification.show .notification-text {
    animation: textFadeIn 0.5s ease-out forwards;
    animation-delay: 0.7s;
}

.notification::before {
    content: '';
    position: absolute;
    top: -5px;
    left: -5px;
    right: -5px;
    bottom: -5px;
    background: linear-gradient(45deg, #4682B4, #20B2AA);
    filter: blur(10px);
    opacity: 0.7;
    z-index: -1;
    border-radius: 50%;
}






    
    
    
    
    
    

 @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-circle {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(255, 255, 255, 0.2);
            border-top: 8px solid #43cea2;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
    h1.main-title {
    color: white !important;
    text-shadow: 0 4px 10px rgba(255, 255, 255, 0.4);
    margin: 2px 0 4px; /* تقليل المسافة العلوية من 4px إلى 2px والسفلية من 8px إلى 4px */
}


/* ✅ طبقة الـ Overlay مع تأثير شفافية */
#overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(10px);
    z-index: 9998;
    display: none;
    transition: opacity 0.3s ease-in-out;
}


@keyframes slideDown {
    0% {
        transform: translate(-50%, -100%);
        opacity: 0;
    }
    100% {
        transform: translate(-50%, -50%);
        opacity: 1;
    }
}

@keyframes slideUp {
    0% {
        transform: translate(-50%, -50%);
        opacity: 1;
    }
    100% {
        transform: translate(-50%, -120%);
        opacity: 0;
    }
}

#promoPopup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -100%);
    width: 90%;
    max-width: 450px;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(25px);
    padding: 30px;
    border-radius: 20px;
    text-align: center;
    color: white;
    box-shadow: 0 0 50px rgba(0, 255, 255, 0.7);
    display: none;
    flex-direction: column;
    justify-content: space-between;
    z-index: 9999;
}


#promoImage {
    width: 100%;
    max-width: 250px;
    border-radius: 15px;
    transition: transform 0.3s ease;
    cursor: pointer;
    overflow: hidden !important;
    clip-path: inset(0 0 0 0 round 15px) !important;
    object-fit: cover;
}

#promoImage:hover {
    transform: scale(1.05);
}

/* ✅ تحسين عنوان النافذة */
.popup-title {
    font-size: 26px;
    font-weight: bold;
    text-shadow: 0 0 30px rgba(255, 255, 255, 0.8);
    background: linear-gradient(135deg, #ffcc00, #ff0066);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

/* ✅ تحسين زر الإغلاق */
#closeBtn {
    padding: 12px 30px;
    font-size: 18px;
    font-weight: bold;
    color: white;
    background: linear-gradient(135deg, #ff0066, #ffcc00);
    border: none;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 0 30px rgba(255, 0, 255, 0.7);
    animation: pulseEffect 2s infinite alternate;
    margin-top: 15px;
    overflow: hidden !important; /* قص أي محتوى أو تأثير خارج الحدود */
    clip-path: inset(0 0 0 0 round 25px) !important; /* قص صارم يطابق border-radius */
    font-family: 'Cairo', sans-serif !important; /* تغيير الخط إلى كايرو */
}

#closeBtn:hover {
    transform: scale(1.1);
    background: linear-gradient(45deg, #43cea2, #185a9d);
}

#closeBtn:active {
    transform: scale(0.95);
    background: linear-gradient(45deg, #43cea2, #185a9d);
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.5) !important; /* ظل داخلي فقط */
    clip-path: inset(0 0 0 0 round 25px) !important; /* تأكيد القص الدائري عند الضغط */
}



        /* Reset and basics */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

     body {
    font-family: 'Tajawal', sans-serif;
    background: linear-gradient(135deg, #3A6073, #16222A);
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    min-height: 100vh;
    padding: 40px 0 50px 0; /* علوية 40px للهيدر، سفلية 50px للفوتر */
    margin: 0;
    background-size: 400% 400%;
    animation: gradientAnimation 10s ease infinite;
}
        @keyframes gradientAnimation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        

     /* تعديل المسافات داخل container */
.container {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(0, 0, 0, 0.1));
    background-size: 400% 400%;
    animation: gradientAnimation 10s ease infinite;
    border-radius: 20px;
    padding: 15px;
    text-align: center;
    width: 90%;
    max-width: 800px;
    margin: 15px auto 30px auto; /* زيادة المسافة السفلية إلى 30px */
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    display: flex;
    flex-direction: column;
    gap: 10px;
}


@media (max-width: 768px) {
    .container {
        width: 95%; /* زيادة العرض للشاشات المتوسطة */
        padding: 15px; /* تقليل الحشوة */
        margin: 15px auto; /* تقليل المسافة العلوية والسفلية */
    }
}
    .results-container {
        max-width: 95%; /* ضبط العرض */
        padding: 8px; /* تقليل الحشوة */
        gap: 10px; /* تقليل المسافة بين العناصر */
    }

    .result-card {
        padding: 10px; /* تقليل الحشوة الداخلية */
    }
}

/* شاشات صغيرة (أقل من 480px) */
@media (max-width: 480px) {
    .container {
        width: 100%; /* استخدام كامل العرض */
        padding: 10px; /* تقليل الحشوة أكثر */
        margin: 10px auto; /* تقليل المسافة أكثر */
    }
}
    .categories {
        grid-template-columns: 1fr; /* تحويل الأعمدة إلى صف واحد */
        gap: 5px; /* تقليل المسافة بين الأزرار */
    }

    .result-card img {
        width: 50px; /* تقليل حجم الصور */
        height: 50px;
    }

    .search-container input {
        padding: 10px 40px 10px 10px; /* تعديل الحشوة لتناسب الشاشات الصغيرة */
    }

    .search-container button {
        width: 35px; /* تقليل حجم زر البحث */
        height: 35px;
        font-size: 14px;
    }
}



/* الشعار (Logo) */


.logo-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 160px;
    height: 160px;
    border-radius: 50%;
    overflow: hidden !important; /* قص التأثيرات */
    box-shadow: 0 4px 10px rgba(255, 255, 255, 0.2);
    cursor: pointer;
    z-index: 1;
    opacity: 1;
    transition: transform 0.3s ease;
    clip-path: circle(80px at center) !important; /* قص دائري يطابق نصف القطر */
}

.logo-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
    border-radius: 50%;
}

.logo-container:active {
    transform: scale(0.95) !important;
    box-shadow: inset 0 8px 16px rgba(0, 0, 0, 0.5) !important; /* ظل داخلي فقط */
    clip-path: circle(80px at center) !important; /* قص صارم */
}

.logo-container img:active {
    transform: scale(1) !important; /* منع الصورة من التأثر */
}
        
h1 {
    font-size: 36px;
    margin-bottom: 5px;
    color: white;
    text-shadow: 0 4px 10px rgba(255, 255, 255, 0.4);
    margin-top: 5px; /* أضف هذه الخاصية لتحديد المسافة من الشعار */
}




/* تقليل المسافة بين أزرار الفئات (أسعار بنمط الكروب، عدد الصيانة، التوافقات) */
.categories {
    display: flex;
    flex-direction: column;
    gap: 10px; /* تقليل المسافة من 15px إلى 10px لتقريب الأزرار */
    align-items: center;
    width: 100%;
}
    .category-btn {
        position: relative;
        overflow: hidden;
        height: 40px; /* تقليل ارتفاع الزر 
        padding-top: 4px; /* رفع النص قليلاً للأعلى */*/
        padding: 8px 16px;
        border-radius: 25px;
        background: rgba(0, 0, 0, 0.3);
        color: white;
        line-height: 40px; /* نفس ارتفاع الزر لتوسيط النص عموديًا */
        font-size: 16px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
         gap: 10px; /* مسافة بين الأيقونة والنص */
         font-family: 'Cairo', sans-serif !important;
     
    }

    .category-btn:hover {
        transform: scale(1.1);
        background: linear-gradient(45deg, #43cea2, #185a9d);
    }

   .category-btn:active {
    transform: scale(0.95); /* تصغير خفيف بدون تمدد */
    background: linear-gradient(45deg, #43cea2, #185a9d);
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3); /* ظل داخلي بدلًا من خارجي */
}

   .new-category-btn, 
.category-btn, 
.tools-btn {
    width: 85%; /* جعل العرض موحد */
    max-width: 250px; /* نفس عرض زر أسعار بنمط الكروب

    
}


    
    .new-category-btn {
            grid-column: span 2; /* يجعل الزر يمتد على عمودين */
            position: relative;
            overflow: hidden;
            height: 40px; /* تقليل ارتفاع الزر 
            padding-top: 20px; /* رفع النص قليلاً للأعلى */*/
            padding: 8px 16px;
            border-radius: 25px;
            background: rgba(0, 0, 0, 0.3);
            color: white;
            line-height: 40px; /* نفس ارتفاع الزر لتوسيط النص عموديًا */
            font-size: 16px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            text-align: center;
             gap: 10px; /* مسافة بين الأيقونة والنص */
             font-family: 'Cairo', sans-serif !important;
        }

        .new-category-btn:hover {
            transform: scale(1.1);
            background: linear-gradient(45deg, #43cea2, #185a9d);
        }

      .new-category-btn:active {
    transform: scale(0.95);
    background: linear-gradient(45deg, #43cea2, #185a9d);
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
}
    
       .category-btn,
       .new-category-btn {
       display: flex;
       align-items: center;
       justify-content: center;
       margin-top: -2px; /* رفع النص قليلاً */
}



.slider-container {
    position: relative;
    width: 100%; /* ✅ نفس عرض شريط الأخبار */
    max-width: none; /* ✅ إزالة الحد الأقصى للعرض */
    overflow: hidden;
    background: rgba(255, 255, 255, 0.1);
    padding: 5px;
    border-radius: 15px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    display: flex;
    align-items: center;
     gap: 8px; /* تقليل المسافة بين الأزرار والسلايدر */
}

.slider {
    display: flex;
    gap: 8px;
    overflow-x: auto;
    scroll-behavior: smooth;
    padding: 5px;
    flex-grow: 1;
}

.slider::-webkit-scrollbar {
    display: none;
}



.category {
    flex: 0 0 auto;
    width: 70px; /* جعل العرض يساوي الارتفاع لتصبح دائرية */
    height: 70px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 50%; /* دائري بدلًا من بيضوي */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: center;
    padding: 6px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    position: relative;
    overflow: hidden !important; /* قص التأثيرات */
    clip-path: circle(35px at center) !important; /* قص دائري يطابق نصف القطر */
    font-weight: bold;
    color: white;
}

/* تأثير الأيقونة */
.category i {
    font-size: 24px;
    margin-bottom: 5px;
    transition: transform 0.3s ease;
}

/* تأثير الأيقونة عند التمرير */
.category:hover i {
    transform: rotate(10deg) scale(1.2);
}

/* النص داخل الزر */
.category span {
    font-size: 12px; /* تقليل حجم النص ليناسب الدائرة */
    white-space: nowrap;
    font-weight: bold;
}

/* تأثير عند التمرير */
.category:hover {
    transform: scale(1.1);
    background: linear-gradient(45deg, #43cea2, #185a9d);
    box-shadow: 0 4px 15px rgba(67, 206, 162, 0.5);
}

/* تأثير عند الضغط */
.category:active {
    transform: scale(0.95) !important;
    background: linear-gradient(45deg, #43cea2, #185a9d) !important;
    box-shadow: inset 0 6px 12px rgba(0, 0, 0, 0.7) !important; /* ظل داخلي فقط */
    clip-path: circle(35px at center) !important; /* قص دائري */
}

/* تأثير عند التحديد */
.category.active {
    background: linear-gradient(135deg, #004D40, #00796B);
    color: white;
    transform: scale(1.15);
    box-shadow: 0 6px 18px rgba(67, 206, 162, 0.7);
}



/* ✅ تأثير نبض عند التحديد */
@keyframes pulseEffect {
    0% { transform: scale(1.15); box-shadow: 0 0 10px rgba(67, 206, 162, 0.5); }
    50% { transform: scale(1.2); box-shadow: 0 0 20px rgba(67, 206, 162, 0.8); }
    100% { transform: scale(1.15); box-shadow: 0 0 10px rgba(67, 206, 162, 0.5); }
}







.slider-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(243, 156, 18, 0.4);
    border: none;
    color: white;
    padding: 8px;
    cursor: pointer;
    border-radius: 50%;
    font-size: 16px;
    width: 38px;
    height: 38px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
    z-index: 10;
    overflow: hidden !important; /* قص صارم */
    clip-path: circle(18px at center); /* دائرة أصغر قليلاً من نصف القطر (19px -> 18px) */
}

.slider-btn:hover {
    background: rgba(243, 156, 18, 0.8);
    transform: translateY(-50%) scale(1.2);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
}

.slider-btn:active {
    transform: translateY(-50%) scale(0.9) !important; /* تصغير قوي */
    background: rgba(243, 156, 18, 1) !important;
    box-shadow: none !important; /* إلغاء الظل الخارجي تمامًا */
    box-shadow: inset 0 6px 12px rgba(0, 0, 0, 0.7) !important; /* ظل داخلي قوي */
    clip-path: circle(18px at center) !important; /* قص دائري صارم */
}

.prev-btn {
    left: 5px;
}

.next-btn {
    right: 5px;
}


.search-container {
    position: relative;
    width: 100%;
    margin: 10px 0; /* العلوية 10px، السفلية 10px */
}

.search-container input {
    width: 100%;
    height: 40px; /* ارتفاع الشريط */
    padding: 8px 16px;
    font-size: 16px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 25px;
    background: rgba(0, 0, 0, 0.3);
    color: white;
    outline: none;
    transition: all 0.3s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

.search-container button {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    background: linear-gradient(45deg, #43cea2, #185a9d);
    border: none;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden !important; /* قص التأثيرات */
    clip-path: circle(15px at center) !important; /* قص دائري يطابق نصف القطر */
}

.search-container button:hover {
    transform: translateY(-50%) scale(1.1);
}

.search-container button:active {
    transform: translateY(-50%) scale(0.95) !important;
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.5) !important; /* ظل داخلي فقط */
    clip-path: circle(15px at center) !important; /* قص صارم */
}

        /* تصميم الهيدر المستقيم */
/* تصميم الهيدر المستقيم */
.header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 40px; /* تغيير من 35px إلى 40px ليطابق الفوتر */
    background: rgba(0, 0, 0, 0.8);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 12px;
    z-index: 2000;
}

/* نص مكتب عسل - في اليمين */
.header-title {
    font-family: 'Cairo', sans-serif;
    font-size: 18px;
    font-weight: 700;
    color: #A3BFFA; /* اللون الأصلي محتفظ به */
    text-shadow: 0 1px 2px rgba(163, 191, 250, 0.4);
    letter-spacing: 0.5px;
    order: 1; /* جعله في اليمين */
}

/* حاوية الأزرار - في اليسار */
.header-buttons {
    display: flex;
    gap: 6px;
    order: 0; /* جعل الأزرار في اليسار */
}

/* تصميم الأزرار */
.header-btn {
    padding: 3px 10px;
    border-radius: 8px;
    border: none;
    background: linear-gradient(135deg, #5A6388, #4A5275); /* لون افتراضي للأزرار */
    color: #fff;
    font-family: 'Cairo', sans-serif;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    overflow: hidden; /* قص التأثيرات الخارجة عن الحدود */
}

/* تأثيرات الضغط */
.header-btn:hover {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.5);
}

.header-btn:active {
    transform: scale(0.95);
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
}

/* زر تحديث */
.header-btn.refresh-btn {
    background: linear-gradient(135deg, #6B7280, #4B5563);
}

.header-btn.refresh-btn:hover {
    background: linear-gradient(135deg, #9CA3AF, #6B7280);
}

/* زر خروج - أحمر غامق */
.header-btn.exit-btn {
    background: linear-gradient(135deg, #8B0000, #B22222); /* أحمر غامق */
}

.header-btn.exit-btn:hover {
    background: linear-gradient(135deg, #CD5C5C, #8B0000); /* تفتيح عند التمرير */
}
        
        
.results {
    display: none;
    flex-direction: column;
    gap: 20px;
    margin-top: 10px;
    padding: 15px;
    background: rgba(0, 0, 0, 0.1);
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    width: 100%;
    transform: translateZ(0); /* تسريع عتادي */
    will-change: display; /* تحسين تغيير الـ display */
}


.no-results {
    color: #ffffff;
    background: rgba(255, 255, 255, 0.1);
    padding: 10px 15px;
    border-radius: 10px;
    text-align: center;
    font-size: 16px;
    font-weight: 500;
    margin-top: 10px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
    width: 80%;
    margin-left: auto;
    margin-right: auto;
    animation: fadeIn 0.3s ease-in-out;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    overflow: hidden !important; /* قص التأثيرات */
    clip-path: inset(0 0 0 0 round 10px) !important; /* قص يطابق border-radius */
}

.no-results:active {
    transform: scale(0.95) !important;
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.5) !important; /* ظل داخلي فقط */
    background: rgba(255, 255, 255, 0.2) !important;
    clip-path: inset(0 0 0 0 round 10px) !important; /* قص صارم */
}


.result-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.5), rgba(50, 50, 50, 0.3));
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4), 0 0 10px rgba(255, 255, 255, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
    cursor: pointer;
    width: 90%;
    max-width: 450px;
    min-width: 250px;
    margin: 0 auto;
    position: relative;
    overflow: hidden !important; /* قص التأثيرات */
    clip-path: inset(0 0 0 0 round 15px) !important; /* قص يطابق border-radius */
    min-height: 200px;
}

.result-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5), 0 0 15px rgba(70, 130, 180, 0.5);
    background: linear-gradient(135deg, rgba(20, 20, 20, 0.6), rgba(70, 130, 180, 0.2));
}

.result-card:active {
    transform: scale(0.97) !important;
    box-shadow: inset 0 6px 12px rgba(0, 0, 0, 0.6) !important; /* ظل داخلي فقط */
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(50, 50, 50, 0.4)) !important;
    clip-path: inset(0 0 0 0 round 15px) !important; /* قص صارم عند الضغط */
}

.result-card img {
    width: clamp(80px, 20vw, 140px); /* زيادة حجم الصورة */
    height: clamp(80px, 20vw, 140px);
    border-radius: 50%;
    margin-bottom: 20px; /* زيادة المسافة تحت الصورة */
    object-fit: cover;
    border: 2px solid rgba(255, 255, 255, 0.2);
    transition: transform 0.3s ease;
}

.result-card:hover img {
    transform: rotate(10deg) scale(1.1);
}

.result-card h4 {
    font-size: clamp(18px, 5vw, 24px); /* زيادة حجم النص */
    font-weight: bold;
    color: white;
    margin: 0 0 20px 0; /* زيادة المسافة تحت الاسم */
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    text-align: center;
    white-space: normal;
    word-wrap: break-word;
    max-width: 90%;
}

.result-card p {
    font-size: clamp(16px, 4.5vw, 22px); /* زيادة حجم السعر */
    color: #fff;
    margin: 0;
    padding: 8px 18px; /* زيادة حشوة المستطيل لتناسب الحجم الجديد */
    background: linear-gradient(45deg, #4682B4, #20B2AA);
    border-radius: 8px;
    font-weight: 600;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    text-align: center;
}

.result-card:hover p {
    transform: scale(1.05);
    box-shadow: 0 4px 10px rgba(70, 130, 180, 0.6);
}

/* Media Queries */
@media (max-width: 480px) { /* موبايل صغير */
    .result-card {
        padding: 15px;
        width: 95%;
        min-height: 180px; /* ارتفاع أدنى للموبايل */
    }

    .result-card img {
        width: clamp(70px, 18vw, 120px); /* حجم أكبر للموبايل */
        height: clamp(70px, 18vw, 120px);
        margin-bottom: 15px;
    }

    .result-card h4 {
        font-size: clamp(16px, 4.5vw, 22px); /* نص أكبر للموبايل */
        margin-bottom: 15px;
    }

    .result-card p {
        font-size: clamp(14px, 4vw, 20px); /* سعر أكبر للموبايل */
        padding: 6px 15px;
    }
}

@media (min-width: 481px) and (max-width: 768px) { /* تابلت */
    .result-card {
        width: 90%;
        min-height: 190px;
    }

    .result-card img {
        width: clamp(80px, 15vw, 130px);
        height: clamp(80px, 15vw, 130px);
    }

    .result-card h4 {
        font-size: clamp(18px, 4.5vw, 24px);
    }

    .result-card p {
        font-size: clamp(16px, 4vw, 22px);
    }
}

@media (min-width: 769px) { /* كمبيوتر */
    .result-card {
        width: 85%;
        max-width: 450px;
        min-height: 200px;
    }

    .result-card img {
        width: 120px; /* حجم ثابت للكمبيوتر */
        height: 120px;
    }

    .result-card h4 {
        font-size: 24px; /* نص أكبر للكمبيوتر */
    }

    .result-card p {
        font-size: 22px; /* سعر أكبر للكمبيوتر */
    }
}

.results-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-height: 600px;
    overflow-y: auto;
    scroll-behavior: smooth;
    border-radius: 10px;
    padding: 10px;
    background: rgba(0, 0, 0, 0.2);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    transform: translateZ(0); /* تسريع عتادي */
}



/* تأثير ظهور تدريجي */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: scale(0.95);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

     


@keyframes shake {
    0%, 100% {
        transform: translateX(0);
    }
    25% {
        transform: translateX(-10px);
    }
    50% {
        transform: translateX(10px);
    }
    75% {
        transform: translateX(-10px);
    }
}


.news-bar {
    display: flex;
    align-items: center;
    justify-content: row-reverse;
    background: rgba(0, 0, 0, 0.3);
    padding: 8px 16px;
    border-radius: 25px;
    width: 100%;
    height: 40px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    margin-bottom: 4px; /* تقليل المسافة السفلية من 8px إلى 4px */
    box-sizing: border-box;
}

/* زر "عاجل" في اليمين */
.breaking-news {
    background: linear-gradient(135deg, #0082B5, #0070A0);
    color: white;
    font-weight: bold;
    padding: 6px 14px;
    border-radius: 20px;
    text-align: center;
    font-size: 14px;
    box-shadow: 0px 0px 10px rgba(0, 130, 181, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    height: 28px;
    margin-left: auto;
    order: 2;
    /* animation: none; */ /* أو احذف السطر ده نهائي */
}

@keyframes pulse {
    0% { transform: scale(1); opacity: 1; }
    100% { transform: scale(1.1); opacity: 0.9; }
}

/* تحسين حاوية الأخبار لجعلها بدون لون إضافي */
.news-ticker-container {
    flex: 1;
    height: 28px;
    overflow: hidden;
    position: relative;
    display: flex;
    align-items: center;
    background: transparent !important; /* ✅ اجعل الخلفية شفافة */
    border-radius: 15px;
    padding: 4px 8px; /* ✅ ضبط الحواف لتكون متساوية */
}

/* تحسين شريط الأخبار ليكون متناسقًا بدون خلفية منفصلة */
.news-ticker {
    display: flex;
    align-items: center;
    white-space: nowrap;
    position: absolute;
    animation: scrollText 60s linear infinite;
    color: white;
    font-weight: bold;
    font-size: 14px;
    gap: 25px;
    direction: rtl;
    unicode-bidi: plaintext;
    background: transparent !important; /* ✅ إزالة لون الخلفية */
}


/* ضبط كل جزء من الخبر لمنع تغيير ترتيب النصوص المختلطة */
.news-ticker span {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-right: 20px;
    direction: rtl; /* ✅ التأكد أن النصوص المختلطة تبقى متناسقة */
    unicode-bidi: embed; /* ✅ يضمن بقاء النصوص الإنجليزية ضمن مكانها الصحيح */
}

    
/* تحسين مظهر الأيقونة مع النص */
.news-ticker img {
    width: 16px;
    height: 16px;
    flex-shrink: 0; /* ✅ منع الأيقونات من التمدد أو التقلص */
}

/* تحسين الروابط داخل الأخبار */
.news-ticker a {
    color: white !important;
    text-decoration: none !important;
    direction: rtl; /* ✅ إجبار النص على البقاء في الاتجاه الصحيح */
}
.news-ticker a:hover {
    text-decoration: underline;
}

@keyframes scrollText {
    from { transform: translateX(-100%); }
    to { transform: translateX(100%); }
}
        


swal2-popup {
    background: rgba(255, 255, 255, 0.1); /* لون شفاف */
    border-radius: 15px;
    color: #fff;
    text-align: center;
    backdrop-filter: blur(10px);
    width: 300px; /* تقليل حجم النافذة */
    padding: 20px;
    font-family: 'Cairo', sans-serif !important;
}

.swal2-title {
    color: white;
    font-size: 24px !important;
    font-weight: bold !important;
    text-shadow: 0 2px 5px rgba(0, 0, 0, 0.7);
    margin-bottom: 15px;
}

.swal2-html-container {
    font-size: 16px !important;
    color: #dcdcdc !important;
    margin: 10px 0;
}

.swal2-actions {
    display: flex !important;
    flex-direction: row !important; /* جعل الأزرار جنب بعض */
    justify-content: center !important;
    gap: 10px !important; /* مسافة بين الأزرار */
    margin-top: 15px;
}


.swal2-confirm, .swal2-cancel {
    padding: 6px 16px !important; /* تقليل الحشوة لتصغير الأزرار */
    font-size: 14px !important; /* تقليل حجم النص */
    border-radius: 20px !important; /* زوايا مستديرة */
    font-weight: 600 !important;
    transition: all 0.3s ease !important;
    color: white !important;
    border: none !important;
    min-width: 60px !important; /* عرض أدنى للأزرار */
    overflow: hidden !important; /* قص التأثيرات */
    clip-path: inset(0 0 0 0 round 20px) !important; /* قص يطابق border-radius */
}

.swal2-confirm {
    background: linear-gradient(135deg, #43cea2, #185a9d) !important;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

.swal2-cancel {
    background: linear-gradient(135deg, #FF416C, #FF4B2B) !important;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

.swal2-confirm:hover, .swal2-cancel:hover {
    transform: scale(1.1);
    box-shadow: 0 8px 16px rgba(255, 255, 255, 0.3);
}

.swal2-confirm:active, .swal2-cancel:active {
    transform: scale(0.95) !important;
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.5) !important; /* ظل داخلي فقط */
    clip-path: inset(0 0 0 0 round 20px) !important; /* قص صارم */
}


.swal2-input {
    width: 90%;
    padding: 12px 15px;
    font-size: 16px;
    color: #ffffff;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 10px;
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.5);
    outline: none;
    transition: all 0.3s ease;
    margin: 10px auto;
    display: block;
    font-family: 'Cairo', sans-serif !important;
}

.swal2-input:focus {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid #43cea2;
    box-shadow: 0 0 10px #43cea2;
}



/* تنسيق زر الرجوع لأعلى */
.scroll-to-top {
    position: fixed;
    bottom: 60px;
    right: 20px;
    background: linear-gradient(45deg, #8B0000, #DC143C);
    color: #fff;
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease, opacity 0.3s ease;
    opacity: 0;
    visibility: hidden;
    z-index: 1000;
    overflow: hidden !important; /* قص صارم */
    clip-path: circle(25px at center); /* قص دائري صارم */
}

.scroll-to-top:hover {
    transform: translateY(-5px) scale(1.1);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
}

.scroll-to-top:active {
    transform: scale(0.9) !important; /* تصغير قوي */
    background: linear-gradient(45deg, #7A0000, #C01234) !important;
    box-shadow: none !important; /* إلغاء الظل الخارجي */
    box-shadow: inset 0 6px 12px rgba(0, 0, 0, 0.7) !important; /* ظل داخلي فقط */
    clip-path: circle(25px at center) !important; /* تأكيد القص الدائري */
}

/* إظهار الزر */
.show-scroll-btn {
    opacity: 1;
    visibility: visible;
}

footer p {
    margin: 0; /* إزالة الهوامش */
    padding: 3px 0; /* تصغير الحشوة العلوية والسفلية */
    font-size: 14px; /* تصغير حجم النص */
    color: white; /* تأكيد اللون الأبيض */
    text-align: center;
}





footer {
    background-color: rgba(0, 0, 0, 0.8); /* جعل الخلفية أكثر وضوحًا */
    color: white;
    text-align: center;
    padding: 10px 0; /* تقليل التباعد لجعله أنيقًا */
    width: 100%;
    font-family: 'Montserrat', sans-serif;
    font-size: 14px;
    box-shadow: 0 -3px 10px rgba(0, 0, 0, 0.4); /* تحسين الظل لجعله أكثر بروزًا */
    position: fixed; /* تثبيت الفوتر أسفل الصفحة */
    bottom: 0; /* تثبيته في الأسفل */
    left: 0;
    z-index: 1000; /* جعله فوق جميع العناصر */
}

/* التأكد من عدم اختفاء المحتوى خلف الفوتر */
body {
    padding-bottom: 50px; /* يضمن عدم تغطية المحتوى بالفوتر */
}




    </style>
</head>
<body>
  
 <button id="scrollToTopBtn" class="scroll-to-top"><i class="fas fa-arrow-up"></i></button>
 
 
 <header class="header">
    <div class="header-title">مكتب عسل</div>
    <div class="header-buttons">
        <button class="header-btn refresh-btn" onclick="refreshData()" title="تحديث البيانات">تحديث</button>
        <button class="header-btn exit-btn" onclick="confirmExit()" title="خروج">خروج</button>
    </div>
</header>
 
 
 <!-- ✅ الطبقة الضبابية Overlay -->
<div id="overlay"></div>

<div id="promoPopup">
    <div class="promo-content">
        <img id="promoImage" src="images/battery6.png" alt="Promo Image">
        <h1 class="popup-title">🔥 عروض خصم على البطاريات – فرصتك الآن! 🔥</h1>
        <p class="promo-text">
            ✅ <strong>خصم يصل إلى 30%</strong><br>
            💥 <strong>بطاريات عالية الجودة وطويلة العمر</strong><br>
            💰 <strong>متوفرة الآن بأسعار مخفضة!</strong><br>
        </p>
        <button id="closeBtn" onclick="closePopup()">⚡ استفد من العرض الآن!</button>
    </div>
</div>

    <div class="container">
      
      
      
    <!-- شعار دائري -->
   <div class="notification-container">
    <div class="logo-container" id="logo"> 
     <img src="images/logo.png" alt="Logo">
    </div>
    <div class="notification" id="notification">
        <div class="notification-text" id="notification-text"></div>
    </div>
</div>
    
    
    
   <h1 class="main-title">ASSAL OFFICE</h1>


<!-- شريط الأخبار -->
<div class="news-bar">
    <div class="breaking-news">🔥 تقنيات</div>
    <div class="news-ticker-container">
        <div class="news-ticker" id="newsTicker">جاري تحميل الأخبار...</div>
    </div>
</div>


        

      <div class="categories">
    <!-- زر أسعار بنمط الكروب -->
     <button class="new-category-btn" onclick="openLCDPage()"><i class="fas fa-list"></i> أسعار بنمط الكروب</button>
          <button class="category-btn tools-btn" onclick="openToolsPage()"><i class="fas fa-shopping-cart"></i> متجر عسل </button>
      <button class="category-btn" onclick="window.location.href='similarites.html'"><i class="fas fa-sync"></i> توافقات قطع الغيار  </button>
           <div class="slider-container">
    <button class="slider-btn prev-btn"><i class="fas fa-chevron-left"></i></button>
    <div class="slider" id="slider">
        <div class="category" onclick="filterCategory('LCD')">
            <i class="fas fa-tv"></i>
            <span>شاشات</span>
        </div>
        <div class="category" onclick="filterCategory('BATTERY')">
            <i class="fas fa-battery-full"></i>
            <span>بطاريات</span>
        </div>
        <div class="category" onclick="filterCategory('HOUSING')">
            <i class="fas fa-mobile-alt"></i>
            <span>شواصي</span>
        </div>
        <div class="category" onclick="filterCategory('BACK')">
            <i class="fas fa-tablet-alt"></i>
            <span>اظهر</span>
        </div>
        <div class="category" onclick="filterCategory('CAMERA')">
            <i class="fas fa-camera"></i>
            <span>كاميرا</span>
        </div>
        <div class="category" onclick="filterCategory('CHARGER')">
            <i class="fas fa-plug"></i>
            <span>شحن</span>
        </div>
        <div class="category" onclick="filterCategory('BELL')">
            <i class="fas fa-bell"></i>
            <span>جرس</span>
        </div>
        <div class="category" onclick="filterCategory('HEADPHONE')">
            <i class="fas fa-volume-up"></i>
            <span>سماعة</span>
        </div>
    </div>
    <button class="slider-btn next-btn"><i class="fas fa-chevron-right"></i></button>
</div>

</div>

        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search for items...">
            <button onclick="searchItems()"><i class="fas fa-search"></i></button>
        </div>
        <div id="results" class="results"></div>

</div>




<footer>
    <p>&copy; 2025 Assal Office. All rights reserved.</p>
</footer>



    <script>
      
      
      
      
 const notifications = [
    "شاشات KBS ضمان بعد الشد",
    "شاشات FLYCDI ضمان بعد الشد",
    "اسعارنا الارخص على مستوى المحافظة",
    "متانة معتمدة اسعار مميزة",
    "مكتبنا الاقدم في مجال قطع الغيار",
    "لسنا الوحيدون لكننا الافضل",
    "مكتب عسل عنوان قطع الغيار في المحافظة",
    "شاشات متينة بضمان كامل",
    "أرخص الأسعار مع الجودة العالية",
    "مكتب عسل الأول في الثقة",
    "قطع غيار بأسعار استثنائية",
    "خبرتنا تضمن رضاكم دائمًا",
    "شاشات FLYCDI جودة لا تُضاهى",
    "مكتبنا عنوان التميز بالمحافظة",
    "أسعار مميزة لكل العملاء",
    "شاشات KBS الأفضل في السوق",
    "مكتب عسل الجودة بأقل تكلفة"
];

function triggerAnimation() {
    const logo = document.getElementById("logo");
    const notification = document.getElementById("notification");
    const notificationText = document.getElementById("notification-text");
    const resultsContainer = document.getElementById("results");

    // إذا النتائج معروضة، نؤخر الانفجار
    if (!logo || !notification || !notificationText || resultsContainer.style.display === "flex") {
        setTimeout(triggerAnimation, 100); // تأخير بسيط جدًا (غير ملحوظ)
        return;
    }

    logo.style.animation = "shake 0.5s ease-in-out";
    setTimeout(() => {
        logo.style.animation = "none";
    }, 500);

    setTimeout(() => {
        logo.style.animation = "explode 0.5s ease-out";
        logo.style.opacity = "0";
    }, 800);

    setTimeout(() => {
        const randomNotification = notifications[Math.floor(Math.random() * notifications.length)];
        notificationText.textContent = randomNotification;
        notification.classList.add("show");
    }, 1300);

    setTimeout(() => {
        notification.classList.remove("show");
        gsap.to(notification, {
            scale: 0.8,
            opacity: 0,
            rotation: 180,
            duration: 0.8,
            ease: "power2.inOut",
            onComplete: () => {
                notification.style.transform = "scale(0)";
            }
        });
    }, 5000);

    setTimeout(() => {
        gsap.set(logo, { scale: 0, opacity: 0, rotation: 0 });
        gsap.to(logo, {
            scale: 1,
            opacity: 1,
            rotation: 720,
            duration: 1.2,
            ease: "bounce.out"
        });
    }, 5800);

    setTimeout(triggerAnimation, 8000);
}
      
      
      
      
 let showPromoPopup = true; // 🔥 يتحكم فقط في النافذة المنبثقة، false = تعطيل النافذة
let promoAlreadyShown = sessionStorage.getItem('promoShown') === 'true';

window.onload = function() { 
    // التحكم في النافذة المنبثقة فقط
    if (showPromoPopup && !promoAlreadyShown) {
        setTimeout(() => {
            document.getElementById('overlay').style.display = 'block';
            let popup = document.getElementById('promoPopup');
            popup.style.display = 'flex';
            popup.style.animation = 'slideDown 0.6s ease-out forwards';
        }, 500);
        sessionStorage.setItem('promoShown', 'true'); // تخزين الحالة لمنع الظهور المتكرر
    }

    // تشغيل الإشعارات بغض النظر عن النافذة المنبثقة
    triggerAnimation();
};


// ✅ حركة الخروج بنفس مسار النزول (لأعلى)
function closePopup() {
    let popup = document.getElementById('promoPopup');
    popup.style.animation = 'slideUp 0.6s ease-in forwards';

    setTimeout(() => {
        popup.style.display = 'none';
        document.getElementById('overlay').style.display = 'none';
    }, 600); // ⏳ وقت متزامن مع الأنيميشن لضمان خروج سلس
}

const slider = document.getElementById('slider');
const prevBtn = document.querySelector('.prev-btn');
const nextBtn = document.querySelector('.next-btn');

prevBtn.addEventListener('click', () => {
    slider.scrollBy({ left: -100, behavior: 'smooth' });
});

nextBtn.addEventListener('click', () => {
    slider.scrollBy({ left: 100, behavior: 'smooth' });
});

function filterCategory(category) {
    alert("تم اختيار: " + category);
}

        
        const dropboxMainFile = "https://assap-app-project.ahmed-al-bayatii-90.workers.dev/file1" + "?t=" + new Date().getTime();
        let database = {};
        let currentCategory = null;

        async function loadExcelFiles() {
            const mainResponse = await fetch(dropboxMainFile);
            const mainBuffer = await mainResponse.arrayBuffer();
            const mainWorkbook = XLSX.read(mainBuffer, { type: "array" });
            database.LCD = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["LCD"] || {});
            database.BATTERY = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["BATTERY"] || {});
            database.HOUSING = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["HOUSING"] || {});
            database.BACK = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["BACK"] || {}); // ✅ تحميل البيانات من شيت "BACK"
           database.CAMERA = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["CAMERA"] || {}); // ✅ تحميل البيانات من شيت "BA

        }
        
        
        
        document.getElementById("searchInput").addEventListener("keydown", function(event) {
    if (event.key === "Enter") {
        event.preventDefault(); // 🔴 منع إعادة تحميل الصفحة
        searchItems(); // ✅ استدعاء البحث
    }
});




        
function filterCategory(category) {
    currentCategory = category;

    // إزالة الفئة "active" من جميع العناصر في القائمة السلايد
    document.querySelectorAll(".category").forEach(cat => cat.classList.remove("active"));

    // إضافة الفئة "active" للعنصر المختار
    const selectedCategory = document.querySelector(`.category[onclick="filterCategory('${category}')"]`);
    if (selectedCategory) {
        selectedCategory.classList.add("active");
    }
}





        function normalizeString(str) {
            return str.replace(/\s+/g, '').toLowerCase();
        }

        
function displayResults(results) {
    const resultsContainer = document.getElementById("results");
    resultsContainer.innerHTML = '';

    if (results.length === 0) {
        resultsContainer.innerHTML = `
            <div class="no-results">
                هذا العنصر غير متوفر في الوقت الحالي
            </div>
        `;
    } else {
        let htmlContent = '';
        results.forEach(item => {
            const imgSrc = currentCategory === "SIMILARITES" 
                ? 'images/default.png'
                : `images/${currentCategory.toLowerCase()}.png`;

            htmlContent += `
                <div class="result-card">
                    <img src="${imgSrc}" alt="Item Image">
                    <h4>${item["Item Name"] || item["Item"]}</h4>
                    ${item["Price"] ? `<p>${item["Price"].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")} د.ع</p>` : '<p>غير متوفر</p>'}
                </div>
            `;
        });
        resultsContainer.innerHTML = htmlContent;
    }

    requestAnimationFrame(() => {
        resultsContainer.style.display = "flex";
        resultsContainer.scrollIntoView({ behavior: "smooth", block: "start" });
        toggleScrollToTopButton();
    });
}

// إخفاء الحاوية عند تفريغ حقل البحث
function searchItems() {
    const searchInput = document.getElementById("searchInput").value.trim();
    const resultsContainer = document.getElementById("results");

    if (!searchInput) {
        resultsContainer.style.display = 'none'; // إخفاء الحاوية إذا الحقل فارغ
        Swal.fire({
            title: 'حقل فارغ',
            html: '<p style="color: #dcdcdc;">يرجى كتابة اسم العنصر قبل المتابعة</p>',
            iconHtml: '<i class="fas fa-exclamation-circle"></i>',
            confirmButtonText: 'موافق',
            customClass: {
                popup: 'swal2-popup',
                title: 'swal2-title',
                htmlContainer: 'swal2-html-container',
                confirmButton: 'swal2-confirm'
            }
        });
        return;
    }

    if (!currentCategory) {
        resultsContainer.style.display = 'none'; // إخفاء الحاوية إذا ما اخترت صنف
        Swal.fire({
            title: 'الصنف غير محدد',
            text: 'يرجى اختيار صنف من القائمة قبل البدء في البحث.',
            iconHtml: '<i class="fas fa-info-circle"></i>',
            confirmButtonText: 'موافق',
            customClass: {
                popup: 'swal2-popup',
                title: 'swal2-title',
                htmlContainer: 'swal2-html-container',
                confirmButton: 'swal2-confirm'
            }
        });
        return;
    }

    const query = normalizeString(searchInput);
    const results = database[currentCategory]?.filter(item =>
        normalizeString(item["Item Name"] || item["Item"]).includes(query)
    ) || [];

    displayResults(results); // استدعاء العرض
}

// دالة الرجوع لأعلى الصفحة
function scrollToTop() {
    window.scrollTo({
        top: 0,
        behavior: 'smooth' // تمرير سلس
    });
}

// التحكم بظهور الزر بناءً على التمرير وعدد النتائج
function toggleScrollToTopButton() {
    const scrollBtn = document.getElementById("scrollToTopBtn");
    const scrollPosition = window.scrollY; // موقع التمرير الحالي
    const results = document.getElementById("results");
    const resultCount = results.children.length; // عدد النتائج

    // الشرط: يظهر الزر إذا كانت هناك نتائج (حتى لو واحدة) وتم التمرير لأسفل أكثر من 100 بكسل
    if (resultCount > 0 && scrollPosition > 100) {
        scrollBtn.classList.add("show-scroll-btn");
    } else {
        scrollBtn.classList.remove("show-scroll-btn");
    }
}


// ربط الزر بالنقر
document.getElementById("scrollToTopBtn").addEventListener("click", scrollToTop);

// الاستماع لحدث التمرير
window.addEventListener("scroll", toggleScrollToTopButton);

// تحديث حالة الزر عند التحميل الأولي
document.addEventListener("DOMContentLoaded", toggleScrollToTopButton);

async function confirmExit() {
    const result = await Swal.fire({
        title: 'تأكيد الخروج',
        html: '<p style="color: #dcdcdc;">هل أنت متأكد أنك تريد الخروج؟</p>',
        iconHtml: '<i class="fas fa-sign-out-alt"></i>',
        showCancelButton: true,
        confirmButtonText: 'نعم', // نص مختصر
        cancelButtonText: 'لا', // نص مختصر
        backdrop: false, // تثبيت الواجهة
        customClass: {
            popup: 'swal2-popup',
            title: 'swal2-title',
            htmlContainer: 'swal2-html-container',
            confirmButton: 'swal2-confirm',
            cancelButton: 'swal2-cancel'
        },
        showClass: {
            popup: 'animate__animated animate__fadeInDown'
        },
        hideClass: {
            popup: 'animate__animated animate__fadeOutUp'
        }
    });

    if (result.isConfirmed) {
        // إغلاق التطبيق
        window.close();
    }
}


function openToolsPage() {
    window.location.href = 'tools.html'; // استبدل 'tools.html' بالرابط إلى الصفحة الجديدة
}


 // دالة لتحويل المستخدم إلى صفحة lcd.html
        function openLCDPage() {
            window.location.href = 'lcd.html';
        }



async function refreshData() {
    // نافذة التحميل مع دائرة التحميل الأنيقة
    Swal.fire({
        html: `
            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <div class="loading-circle" style="
                    width: 80px;
                    height: 80px;
                    border: 8px solid rgba(255, 255, 255, 0.2);
                    border-top: 8px solid #43cea2;
                    border-radius: 50%;
                    animation: spin 1s linear infinite;">
                </div>
                <p style="margin-top: 20px; font-size: 18px; color: #dcdcdc;">جارِ التحديث... يرجى الانتظار</p >
            </div>
        `,
        showConfirmButton: false,
        allowOutsideClick: false,
        backdrop: 'rgba(0, 0, 0, 0.8)',
         backdrop: false, // تثبيت الواجهة
        customClass: {
            popup: 'swal2-popup animate__animated animate__fadeInDown', // حركة دخول
        },
    });

    // محاكاة لمدة 3 ثوانٍ مع تحميل الملفات
    const loadingPromise = new Promise(resolve => setTimeout(resolve, 3000));
    const loadFilesPromise = loadExcelFiles();

    try {
        // انتظر انتهاء المحاكاة وتحميل الملفات معًا
        await Promise.all([loadingPromise, loadFilesPromise]);

        // نافذة نجاح التحديث مع زر موافق
        Swal.fire({
            title: 'تم التحديث بنجاح!',
            html: '<p style="color: #dcdcdc;">تم تحديث البيانات بنجاح. يمكنك المتابعة الآن.</p >',
            iconHtml: '<i class="fas fa-check-circle" style="font-size: 50px; color: #43cea2;"></i>',
            showConfirmButton: false, // عرض زر موافق
            confirmButtonText: 'موافق',
            backdrop: 'rgba(0, 0, 0, 0.7)',
             backdrop: false, // تثبيت الواجهة
            customClass: {
                popup: 'swal2-popup animate__animated animate__fadeInDown', // حركة دخول
                title: 'swal2-title',
                htmlContainer: 'swal2-html-container',
                confirmButton: 'swal2-confirm',
            },

     }).then((result) => {
            if (result.isConfirmed) {
                sessionStorage.setItem('hasUpdated', true);
                console.log('Data updated and session state saved successfully.');
                // إغلاق النافذة بشكل صريح
                Swal.fire({
                    title: 'تم التحديث بنجاح!',
                    text: 'تم إغلاق النافذة بنجاح.',
                    showConfirmButton: false,
                    timer: 1500
                }).then(() => {
                    Swal.close();
                });
            }
        });

        
    } catch (error) {
        // نافذة خطأ في حالة حدوث مشكلة أثناء التحميل
        Swal.fire({
            title: 'خطأ',
            html: '<p style="color: #ff4d4d;">حدث خطأ أثناء تحديث البيانات. يرجى المحاولة لاحقًا.</p >',
            iconHtml: '<i class="fas fa-exclamation-triangle" style="font-size: 50px; color: #ff4d4d;"></i>',
            showConfirmButton: true,
            backdrop: 'rgba(0, 0, 0, 0.7)',
            confirmButtonText: 'موافق',
             backdrop: false, // تثبيت الواجهة
            customClass: {
                popup: 'swal2-popup animate__animated animate__shakeX', // حركة اهتزاز عند الخطأ
                title: 'swal2-title',
                htmlContainer: 'swal2-html-container',
                confirmButton: 'swal2-confirm',
            },
            
        });
    }

loadExcelFiles().then(() => {
    setTimeout(() => {
        location.reload();
    }, 1000); // تأخير لمدة 3 ثواني (3000 مللي ثانية)
});
    
}
        
        loadExcelFiles();

 let newsInterval = null;

async function fetchTechNews() {
    const rssToJsonUrl = "https://api.rss2json.com/v1/api.json?rss_url=https://aitnews.com/feed/";
    const resultsContainer = document.getElementById("results");

    // إذا النتائج معروضة، لا تحدث الأخبار
    if (resultsContainer.style.display === "flex") {
        return;
    }

    try {
        const response = await fetch(rssToJsonUrl);
        const data = await response.json();
        let newsItems = [];

        if (data.items) {
            data.items.forEach(item => {
                let title = item.title;
                let link = item.link;
                let icon = "https://cdn-icons-png.flaticon.com/16/1041/1041916.png";
                newsItems.push(`<span><img src="${icon}" alt="📢"><a href="${link}" target="_blank">${title}</a></span>`);
            });
        }

        if (newsItems.length > 0) {
            document.getElementById("newsTicker").innerHTML = newsItems.join(" | ");
        } else {
            document.getElementById("newsTicker").textContent = "⚠️ لا توجد أخبار متاحة الآن";
        }
    } catch (error) {
        console.error("Error fetching news:", error);
        document.getElementById("newsTicker").textContent = "⚠️ تعذر تحميل الأخبار";
    }
}

function restartNewsTicker() {
    const ticker = document.querySelector(".news-ticker");
    const resultsContainer = document.getElementById("results");

    if (ticker && resultsContainer.style.display !== "flex") { // فقط إذا النتائج مو معروضة
        ticker.style.animation = "none";
        void ticker.offsetWidth;
        ticker.style.animation = "scrollText 60s linear infinite";
    }
}

function refreshNewsTicker() {
    const resultsContainer = document.getElementById("results");

    if (resultsContainer.style.display !== "flex") { // فقط إذا النتائج مو معروضة
        fetchTechNews(); // جلب الأخبار
        restartNewsTicker(); // إعادة تشغيل الحركة
    }
}

// دوال التحكم بالتحديث
function startNewsUpdates() {
    if (!newsInterval) {
        newsInterval = setInterval(fetchTechNews, 60000); // تحديث كل دقيقة
    }
}

function stopNewsUpdates() {
    if (newsInterval) {
        clearInterval(newsInterval);
        newsInterval = null;
    }
}

// التشغيل الأولي والتحكم
fetchTechNews(); // تحميل أولي
startNewsUpdates();

// ربط التحكم مع عرض النتائج
document.getElementById("results").addEventListener("transitionend", () => {
    if (document.getElementById("results").style.display === "flex") {
        stopNewsUpdates();
    } else {
        startNewsUpdates();
    }
});

// التعامل مع الأحداث الأخرى
document.addEventListener("click", function(event) {
    if (event.target.closest(".swal2-popup") || event.target.classList.contains("swal2-close") || 
        event.target.classList.contains("swal2-confirm") || event.target.classList.contains("swal2-cancel")) {
        setTimeout(refreshNewsTicker, 500); // تحديث الأخبار بعد إغلاق النافذة
    }
});

window.addEventListener("pageshow", function() {
    refreshNewsTicker(); // إعادة تشغيل الأخبار بعد العودة
});

window.addEventListener("load", function() {
    refreshNewsTicker(); // إعادة تشغيل الأخبار عند التحميل
});

        
    </script>
    <style>
    
    
        .swal2-popup {
            background: rgba(255, 255, 255, 0.1); /* لون شفاف */
            border-radius: 15px;
            color: #fff;
            text-align: center;
            backdrop-filter: blur(10px);
            width: 300px; /* تقليل حجم النافذة */
        }
        .swal2-title {
            color: white;
            text-shadow: 0 4
